(this["webpackJsonpalrashid-po-application"]=this["webpackJsonpalrashid-po-application"]||[]).push([[0],{129:function(e,t,a){},466:function(e,t){},552:function(e,t,a){e.exports=a(873)},558:function(e,t,a){},565:function(e,t,a){},568:function(e,t,a){e.exports=a.p+"static/media/alrashid-logo.b498335f.png"},582:function(e,t,a){},625:function(e,t){},627:function(e,t){},639:function(e,t){},641:function(e,t){},666:function(e,t){},668:function(e,t){},669:function(e,t){},675:function(e,t){},677:function(e,t){},695:function(e,t){},698:function(e,t){},714:function(e,t){},717:function(e,t){},722:function(e,t){},723:function(e,t){},873:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(19),l=a.n(s),c=a(198),o=(a(557),a(558),a(35)),i=a(36),u=a(38),m=a(37),d=a(27),p=a(28),h=a(892),f=a(893),E=a(894),b=a(22),v=a.n(b),g=a(74),O=a(7),y=a.n(O),D=a(14),P=function(){var e=Object(D.a)(y.a.mark((function e(t,a){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$filter=TaskOutcome eq null and AssignedTo eq '").concat(a,"'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r.d.results);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),S=function(){var e=Object(D.a)(y.a.mark((function e(t,a){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$filter=TaskOutcome ne null and AssignedTo eq '").concat(a,"'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,console.log(r.d.results.length),e.abrupt("return",r.d.results);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),N=function(){var e=Object(D.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/pmo/_api/web/CurrentUser",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,console.log("Current logged in user",a.d.Id),e.abrupt("return",a.d.Id);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=(a(563),a(564),a(565),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={load:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{id:"ToggleNav",className:v()("sidebar",{"is-open":this.props.isOpen})},r.a.createElement("div",{className:"sidebar-header"},r.a.createElement("span",{color:"info",onClick:this.props.toggle,style:{color:"#fff"}},"\xd7"),r.a.createElement("h5",null,"Purchase Order App")),r.a.createElement("div",{className:"side-menu"},r.a.createElement(h.a,{vertical:!0,className:"list-unstyled pb-3"},r.a.createElement(f.a,null,r.a.createElement(E.a,{tag:g.a,to:"/po-search"},r.a.createElement(d.a,{icon:p.d,className:"mr-2"}),"New Request")),r.a.createElement(f.a,null,r.a.createElement(E.a,{tag:g.a,to:"/pages/my-requests"},r.a.createElement(d.a,{icon:p.d,className:"mr-2"}),"PO Requests")),r.a.createElement(f.a,null,r.a.createElement(E.a,{tag:g.a,to:"/pages/my-tasks"},r.a.createElement(d.a,{icon:p.d,className:"mr-2"}),"Pending Tasks")),r.a.createElement(f.a,null,r.a.createElement(E.a,{tag:g.a,to:"/pages/my-completed"},r.a.createElement(d.a,{icon:p.d,className:"mr-2"}),"Completed Tasks")),r.a.createElement(f.a,null,r.a.createElement(E.a,{tag:g.a,to:"/pages/Dashboard"},r.a.createElement(d.a,{icon:p.d,className:"mr-2"}),"Dashboard")),r.a.createElement(f.a,null,r.a.createElement(E.a,{tag:g.a,to:"/pages/ExportPO"},r.a.createElement(d.a,{icon:p.d,className:"mr-2"}),"Export PO")))))}}]),a}(n.Component)),j=a(917),k=a(904),x=a(895),T=a(896),C=a(897),A=a(920),M=(a(568),function(){var e=Object(D.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/pmo/_api/web/CurrentUser",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,console.log("Current logged in user",a.d),e.abrupt("return",a.d);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),R=function(e){var t=Object(n.useState)(!1),a=Object(c.a)(t,2),s=a[0],l=a[1],o=Object(n.useState)(""),i=Object(c.a)(o,2),u=i[0],m=i[1];Object(n.useEffect)((function(){M().then((function(e){return m("Welcome, ".concat(e.Title))}))}),[]);var b={fontWeight:"500"};return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{color:"light",light:!0,className:"navbar shadow-lg p-3 mb-3 bg-white rounded",expand:"md"},r.a.createElement(T.a,{color:"secondary",className:"btn-toggle-nav",onClick:e.toggle},r.a.createElement(d.a,{icon:p.a})),r.a.createElement(C.a,{className:"nav-toggler",onClick:function(){return l(!s)}}),r.a.createElement("img",{className:"logo",src:"https://alrashidabetong.sharepoint.com/sites/apps/PMO/SiteAssets/PO_App/alrashid-logo.b498335f.png",alt:"AL RASHID ABETONG LOGO"}),r.a.createElement(A.a,{isOpen:s,navbar:!0},r.a.createElement(h.a,{className:"ml-auto",navbar:!0},r.a.createElement(f.a,null,r.a.createElement(E.a,{style:{color:"rgb(35,86,151)",fontSize:"22px",marginTop:"-4px"}})),r.a.createElement(f.a,null,r.a.createElement(E.a,{style:b},r.a.createElement(d.a,{icon:p.h,className:"mr-2"}),u)),r.a.createElement(f.a,null,r.a.createElement(E.a,{style:b,href:"https://alrashidabetong.sharepoint.com/sites/apps/PMO/_layouts/15/SignOut.aspx"},r.a.createElement(d.a,{icon:p.f,className:"mr-2"}),"Sign Out"))))))},I=a(123),F=a(523),G=a(121),q=a(249),V=a(898),$=a(899),W=a(900),U=a(901),_=a(902),B=a(903),L=(a(129),a(54)),Y=a.n(L),z=a(274),J=a.n(z),H=a(77),Z=a.n(H),Q=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://po-webapi.alrashidabetong.com/api/PODetails?PONumber=".concat(t),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a;case 5:if(!e.sent.ok){e.next=13;break}return e.next=9,a.json();case 9:return n=e.sent,e.abrupt("return",JSON.parse(n));case 13:alert("Purchase Order Fetching API is not working. Please check with your IT Support.");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(D.a)(y.a.mark((function e(t,a){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=ID,chff,POStatus,vwno,Created,POVersion&$orderby=ID desc&$filter=chff eq ").concat(a),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,console.log("Data from list",r.d),e.abrupt("return",r.d.results);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),K=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://po-webapi.alrashidabetong.com/api/PODetails?recepient=".concat(t,"&PONumber=").concat(a,"&OTP=").concat(n),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log("Email Send Status",s),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),ee={fontSize:"12px"},te=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).SearchPO=function(){n.validateSearchInput()&&n.setState({POLoading:!0},n.validateExistingPO(n.state.searchInput))},n.validateExistingPO=function(e){X("PMO",e).then((function(e){if(e.length>0){var t,a=[],s=[],l=[],c=Object(G.a)(e);try{for(c.s();!(t=c.n()).done;){var o=t.value;null!==o.POStatus&&(o.POStatus.indexOf("InProgress")>-1&&a.push(o),o.POStatus.indexOf("Approved")>-1&&s.push(o),o.POStatus.indexOf("Rejected")>-1&&l.push(o))}}catch(p){c.e(p)}finally{c.f()}if(a.length>0){var i=a.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.vwno),r.a.createElement("td",null,e.chff),r.a.createElement("td",null,e.POVersion),r.a.createElement("td",null,e.POStatus),r.a.createElement("td",null,r.a.createElement(Z.a,{format:"DD-MM-YY hh:mm"},e.Created)))})),u=r.a.createElement(V.a,{striped:!0,size:"sm",responsive:!0,style:ee},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Ticket Number"),r.a.createElement("th",null,"PO Number"),r.a.createElement("th",null,"Revision"),r.a.createElement("th",null,"Request Status"),r.a.createElement("th",null,"Created Date"))),r.a.createElement("tbody",null,i));J()({text:"Below PO Requests are already in Progress. You cannot Submit another request Now",buttons:{Ok:{text:"Ok",value:"Ok"}},content:r.a.createElement("div",null,u)}).then((function(e){"Ok"===e&&n.setState({POLoading:!1})}))}if(l.length>0){s.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.vwno),r.a.createElement("td",null,e.chff),r.a.createElement("td",null,e.POVersion),r.a.createElement("td",null,e.POStatus),r.a.createElement("td",null,r.a.createElement(Z.a,{format:"DD-MM-YY hh:mm"},e.Created)))}));J()({text:"Request has been rejected before, Do you want to continue?",buttons:{Yes:{text:"Yes",value:"Yes"},No:{text:"No",value:"No"}}}).then((function(e){switch(e){case"Yes":Q(n.state.searchInput).then((function(e){return n.loadPODetails(e)})).catch((function(e){return console.error("API Error",e)}));break;case"No":n.setState({POLoading:!1});break;default:Y()("Something is wrong!!")}}))}if(s.length>0&&a.length<1){var m=s.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.vwno),r.a.createElement("td",null,e.chff),r.a.createElement("td",null,e.POVersion),r.a.createElement("td",null,e.POStatus),r.a.createElement("td",null,r.a.createElement(Z.a,{format:"DD-MM-YY hh:mm"},e.Created)))})),d=r.a.createElement(V.a,{striped:!0,size:"sm",responsive:!0,style:ee},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Ticket Number"),r.a.createElement("th",null,"PO Number"),r.a.createElement("th",null,"Revision"),r.a.createElement("th",null,"Request Status"),r.a.createElement("th",null,"Created Date"))),r.a.createElement("tbody",null,m));J()({text:"Below PO Requests are already Approved. Do you want to re-process?",buttons:{Yes:{text:"Yes",value:"Yes"},No:{text:"No",value:"No"}},content:r.a.createElement("div",null,d)}).then((function(e){switch(e){case"Yes":Q(n.state.searchInput).then((function(e){return n.loadPODetails(e)}));break;case"No":n.setState({POLoading:!1});break;default:Y()("Something is wrong!!")}}))}}else Q(n.state.searchInput).then((function(e){return n.loadPODetails(e)}))}))},n.loadPODetails=function(){var e=Object(D.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t.PONumber?(Y()("There is no record with this PO Number"),n.setState({POLoading:!1})):n.setState({PODetails:t,POLoading:!1},n.OTPValidate);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={searchInput:null,searchInputValid:!0,POLoading:!1,POLoaded:!1,OTPValid:!1,PODetails:{},RejectedItems:{}},n.handleSearchInputChange=n.handleSearchInputChange.bind(Object(q.a)(n)),n}return Object(i.a)(a,[{key:"validateSearchInput",value:function(){var e=!0;return null===this.state.searchInput&&(e=!1,Y()("Search Input is empty")),e}},{key:"OTPValidate",value:function(){var e=this,t=Math.floor(1e5+9e5*Math.random());console.log(t,this.state),K(this.state.PODetails.MakerEmail,this.state.PODetails.PONumber,t),localStorage.setItem("OTP",t);var a=document.createElement("input");a.setAttribute("placeholder","6 Digit Code"),a.setAttribute("ID","OTP"),Y()({title:"Enter OTP",text:"Enter the OTP sent to your email:",icon:"info",buttons:{ResendOTP:{},Confirm:{Text:"Confirm"}},content:a}).then((function(t){var n=a.value;switch(console.log(n),t){case"Confirm":""===n||n!==localStorage.getItem("OTP")?Y()("You have entered invalid or empty OTP"):n===localStorage.getItem("OTP")&&Y()("You are sucessfully validated").then(e.setState({OTPValid:!0,POLoading:!1,POLoaded:!0}));break;case"ResendOTP":localStorage.removeItem("OTP"),e.OTPValidate()}}))}},{key:"handleSearchInputChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(F.a)({},n,a))}},{key:"render",value:function(){var e=this.state.POLoading,t=null;return!1===this.state.POLoaded&&(t=r.a.createElement($.a,{className:""},r.a.createElement(W.a,null,r.a.createElement(U.a,{row:!0,className:"form-header-container"},r.a.createElement(d.a,{icon:p.e,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Search by PO Number")),r.a.createElement(U.a,{row:!0},r.a.createElement(_.a,{className:"search-input-col text-center"},r.a.createElement(B.a,{type:"number",name:"searchInput",className:"POSearchInput",placeholder:"Enter PO Number to search",onChange:this.handleSearchInputChange}),r.a.createElement(T.a,{type:"button",color:"success",className:"btn-po-search mt-2",onClick:this.SearchPO,disabled:e},e?r.a.createElement(d.a,{icon:p.g,className:"mr-2"}):null,"Search")))))),console.log("PO Detals in state is",this.state),r.a.createElement("div",{style:{width:"100%"}},t,this.state.POLoaded?r.a.createElement(I.b,{to:{pathname:"/po-request/new",state:{podetails:this.state.PODetails}}}):null)}}]),a}(n.Component),ae=a(905),ne=a(53),re=a(525),se=a.n(re),le=a(199),ce=a(524),oe=a.n(ce),ie=a(919),ue=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"},body:JSON.stringify(t)},e.next=3,fetch("https://po-webapi.alrashidabetong.com/api/attachment/Upload",a);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,console.log("Attachment Upload Response API",r),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://po-webapi.alrashidabetong.com/api/Attachment/GetAttach?refId=".concat(t),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://po-webapi.alrashidabetong.com/api/Attachment/deletefile?refId=".concat(t,"&title=").concat(a,"&path=").concat(n),{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log("Attachment DELETION Status",s),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),pe=(a(582),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).UpdateAttachmentDetailsInView=function(){me(n.state.RefID).then((function(e){console.log("All Attachments in View Mode",JSON.parse(e)),n.setState({uploadedFiles:JSON.parse(e)})}))},n.handleAttachmentTable=function(){var e="C:\\POAttachments\\".concat(n.state.RefID,"\\Attachments\\").concat(n.state.selectedFiles.name),t={Title:n.state.selectedFiles.name,Path:e,FileSize:n.state.selectedFiles.size},a=Object(le.a)(n.state.uploadedFiles);a.push(t),n.setState({uploadedFiles:a},n.UpdateStateInForm)},n.UpdateStateInForm=function(){n.props.handleFileCommit(n.state.RefID),l.a.findDOMNode(n.refs.form).disabled=!1},n.deleteAttachment=function(e){n.setState({deleting:!0}),de(n.state.RefID,e.Title,e.Path).then(n.setState({deleting:!1},n.UpdateAttachmentDetailsInView))},n.state={selectedFiles:null,selected:!1,RefID:null,uploadedFiles:[],uploading:!1,deleting:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){if("view"===this.props.mode)console.log("RefID View Mode",this.props.AttachmentRefID),this.setState({RefID:this.props.AttachmentRefID},this.UpdateAttachmentDetailsInView);else{var e=Object(ie.a)();this.setState({RefID:e})}}},{key:"getFiles",value:function(e){this.setState({selectedFiles:e,selected:!0})}},{key:"FileUploadHanler",value:function(){var e=this;l.a.findDOMNode(this.refs.form).disabled=!0;var t={Filebase:this.state.selectedFiles.base64,Title:this.state.selectedFiles.name,RefID:this.state.RefID,ApplicationName:"POApprovalApp",AttachmentType:"attachment",uploadStatus:"draft"};this.setState({uploading:!0}),ue(t).then((function(t){return e.setState({uploading:!1,selected:!1},e.handleAttachmentTable)})),l.a.findDOMNode(this.refs.form).value=""}},{key:"render",value:function(){var e,t,a,n=this;return console.log("Delete State",this.state),console.log("File Reference",this.state.RefID),console.log("Uploaded Files",this.state.uploadedFiles),console.log("FileUpload Property Passed",this.props),e=this.state.uploadedFiles.length>0?this.state.uploadedFiles.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,r.a.createElement("a",{className:"attachment-link",rel:"noopener noreferrer",href:"https://po-webapi.alrashidabetong.com/api/Attachment/Getfile?title=".concat(e.Title,"&path=").concat(e.Path),target:"_blank"},e.Title)),r.a.createElement("td",null,e.FileSize),"new"===n.props.mode?r.a.createElement("td",{className:"attachment-delete"},n.state.deleting?r.a.createElement(d.a,{icon:p.g}):r.a.createElement(T.a,{type:"button",onClick:function(){return n.deleteAttachment(e)},className:"btn btn-danger attach-del-btn"},"Delete")):r.a.createElement("td",null))})):r.a.createElement("tr",{className:"text-center"},r.a.createElement("td",{colSpan:"3"},"No Attachment Added")),a=this.state.uploading?r.a.createElement("div",null,r.a.createElement(d.a,{icon:p.g,className:"mt-4 mr-4  file-upload-btn"}),"File Uploading"):r.a.createElement(T.a,{className:"Primary file-upload-btn",type:"button",onClick:this.FileUploadHanler.bind(this),disabled:!this.state.selected},"Upload"),"new"===this.props.mode&&(t=r.a.createElement(k.a,null,r.a.createElement(_.a,{md:12},r.a.createElement("label",{className:"AttachmentLabel"},"Upload Supporting Documents ")),r.a.createElement(_.a,{md:6},r.a.createElement("div",{className:"files color"},r.a.createElement(oe.a,{ref:"form",className:"form-control",multiple:!1,onDone:this.getFiles.bind(this)}))),r.a.createElement(_.a,{md:2},a))),r.a.createElement(r.a.Fragment,null,t,r.a.createElement(k.a,null,r.a.createElement(_.a,{md:6},r.a.createElement(V.a,{striped:!0,className:"mt-2"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Attachment Name"),r.a.createElement("th",null,"Size"),r.a.createElement("th",null))),r.a.createElement("tbody",null,e)))))}}]),a}(n.Component)),he=function(){var e=Object(D.a)(y.a.mark((function e(){var t,a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}},e.next=3,fetch("/sites/apps/PMO/_api/contextinfo",t);case 3:return a=e.sent,e.next=6,a.json();case 6:return n=e.sent,e.abrupt("return",n.d.GetContextWebInformation.FormDigestValue);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$top=10000&$orderby=ID desc')"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.d.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose","X-RequestDigest":n,credentials:"same-origin"},body:JSON.stringify(a)},console.log(r),e.next=4,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items"),r);case 4:return s=e.sent,e.next=7,s.json();case 7:return l=e.sent,e.abrupt("return",l.d);case 9:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),be=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://po-webapi.alrashidabetong.com/api/Attachment/CommitAttachments?refId=".concat(t),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,console.log("Attachment Commit Status",n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=Object(D.a)(y.a.mark((function e(t,a){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items('").concat(a,"')"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r.d);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ge=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).createPOItemHandler=function(t){if(t.preventDefault(),""===e.state.SelectedDepartment)Y()("Deepartment Input is Empty!!");else{(function(){e.refs.Btn.setAttribute("disabled","disabled")});var a=JSON.stringify(e.state.podetails.GrandTotal).replace(/"/g,""),n=Math.trunc(a),r={Title:e.state.podetails.PONumber,chff:e.state.podetails.PONumber,POJSONData:JSON.stringify(e.state.podetails),j3xm:e.state.podetails.MakerName,zh3a:e.state.podetails.MakerEmail,ozud:e.state.SelectedDepartment,POVersion:JSON.stringify(e.state.podetails.POVersion),AttachmentReferenceNumber:e.state.AttachmentsReferenceNumber,yyrh:JSON.stringify(e.state.podetails.GrandTotal),Num:n,Currency:JSON.stringify(e.state.podetails.Currency)};he().then((function(t){return Ee("PMO",r,t).then(be(e.state.AttachmentsReferenceNumber)).then(e.setState({redirectMyRequest:!0}))}))}},e.CommitAttachment=function(t){e.setState({AttachmentsReferenceNumber:t})},e.state={redirectMyRequest:!1,podetails:{POItems:[],POAdditionalInfo:[]},Departments:{},SelectedDepartment:"",AttachmentsReferenceNumber:null},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;"new"===this.props.match.params.mode?(this.setState({podetails:this.props.location.state.podetails}),fe("Department Managers").then((function(t){e.setState({Departments:t})}))):"view"===this.props.match.params.mode&&ve("PMO",this.props.match.params.id).then((function(t){e.setState({podetails:JSON.parse(t.POJSONData),SelectedDepartment:t.ozud,AttachmentsReferenceNumber:t.AttachmentReferenceNumber})}))}},{key:"onDepartmentChange",value:function(e){this.setState({SelectedDepartment:e[0].Title})}},{key:"render",value:function(){var e=this;if(console.log("State",this.state),!0===this.state.redirectMyRequest)return r.a.createElement(I.b,{to:"/pages/my-requests"});var t,a,n,s={textAlign:"right"},l={background:"#eeeeee",fontWeight:"bold"},c=null,o=null;return"new"===this.props.match.params.mode?(c=r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{row:!0},r.a.createElement(_.a,{md:12,className:"text-right"},r.a.createElement(T.a,{className:"mr-2 btn-cancel",color:"primary"},"Cancel"),r.a.createElement(T.a,{ref:"Btn",color:"danger",onClick:this.createPOItemHandler},"Submit")))),t=r.a.createElement(se.a,{className:"po-input",clearable:!0,options:this.state.Departments,labelField:"Title",valueField:"Title",onChange:function(t){return e.onDepartmentChange(t)}})):"view"===this.props.match.params.mode&&(t=r.a.createElement(B.a,{className:"po-input",value:this.state.SelectedDepartment||"",type:"text",name:"",id:"initiatorDepartment",disabled:!0})),this.state.podetails.POItems&&(a=this.state.podetails.POItems.map((function(e){return r.a.createElement("tr",{key:e.SLNO},r.a.createElement("th",{scope:"row"},e.SLNO),r.a.createElement("td",null,e.Proj),r.a.createElement("td",null,e.Dept),r.a.createElement("td",null,e.Prod),r.a.createElement("td",null,e.WHse),r.a.createElement("td",null,e.ItemCode),r.a.createElement("td",null,e.Description),r.a.createElement("td",null,e.DelDate),r.a.createElement("td",{style:s},e.code),r.a.createElement("td",{style:s},e.quantity),r.a.createElement("td",{style:s},r.a.createElement(ne.a,{value:e.UnitPrice||0,displayType:"text",thousandSeparator:!0})),r.a.createElement("td",{style:s},r.a.createElement(ne.a,{value:e.TotalPrice||0,displayType:"text",thousandSeparator:!0})))}))),console.log("Addtional Info",this.state.podetails.POAdditionalInfo.length),this.state.podetails.POAdditionalInfo&&(n=this.state.podetails.POAdditionalInfo.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.SNo),r.a.createElement("td",null,e.Type))}))),0===this.state.podetails.POAdditionalInfo.length&&(n=r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2"},"No Addtional Info"))),"new"!==this.props.match.params.mode&&null===this.state.AttachmentsReferenceNumber||(o=r.a.createElement(pe,{mode:this.props.match.params.mode,handleFileCommit:this.CommitAttachment,AttachmentRefID:this.state.AttachmentsReferenceNumber})),r.a.createElement("div",{className:"form-container"},r.a.createElement($.a,null,r.a.createElement(W.a,null,r.a.createElement(U.a,{row:!0,className:"form-header-container"},r.a.createElement(d.a,{icon:p.b,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Purchase Order Details")),r.a.createElement(U.a,{row:!0},r.a.createElement(_.a,{md:4},r.a.createElement(ae.a,{for:"initiatorName"},"Maker Name"),r.a.createElement(B.a,{className:"po-input",value:this.state.podetails.MakerName||"",type:"text",name:"maker-name",id:"initiatorDepartment",disabled:!0})),r.a.createElement(_.a,{md:4},r.a.createElement(ae.a,{for:"initiatorName"},"Maker Email"),r.a.createElement(B.a,{className:"po-input",value:this.state.podetails.MakerEmail||"",type:"text",name:"email",id:"initiatorEmail",disabled:!0})),r.a.createElement(_.a,{md:4},r.a.createElement(ae.a,{for:"initiatorDepartment"},"Department"),t)),r.a.createElement(U.a,{row:!0},r.a.createElement(_.a,{md:4},r.a.createElement(ae.a,{for:"createdDate"},"Created Date"),r.a.createElement(B.a,{className:"po-input",defaultValue:this.state.podetails.CreatedDate||"",type:"text",name:"date",id:"createdDate"})),r.a.createElement(_.a,{md:4},r.a.createElement(ae.a,{for:"poNumber"},"PO Number"),r.a.createElement(B.a,{className:"po-input",value:this.state.podetails.PONumber||"",type:"text",name:"poNumber",id:"poNumber",disabled:!0})),r.a.createElement(_.a,{md:4,className:"d-flex align-items-center"})),r.a.createElement(U.a,{row:!0,className:"form-header-container",style:{margin:0}},r.a.createElement(d.a,{icon:p.b,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Item Details")),r.a.createElement("div",{className:"table-responsive-md"},r.a.createElement(V.a,{bordered:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"#"),r.a.createElement("th",{scope:"col",colSpan:"4",className:"th-main align-middle text-center"},"Dimension"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Item Code"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Description"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Del. Date"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Unit Code"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Quantity"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Unit Price"),r.a.createElement("th",{scope:"col",rowSpan:"2",className:"th-main align-middle text-center"},"Total price")),r.a.createElement("tr",null,r.a.createElement("th",{scope:"col",className:"th-sub align-middle text-center"},"Proj."),r.a.createElement("th",{scope:"col",className:"th-sub align-middle text-center"},"Dept"),r.a.createElement("th",{scope:"col",className:"th-sub align-middle text-center"},"Prod"),r.a.createElement("th",{scope:"col",className:"th-sub align-middle text-center"},"W.Hse"))),r.a.createElement("tbody",null,a),r.a.createElement("tfoot",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"2"},"Grand Total (",this.state.podetails.Currency,")"),r.a.createElement("th",{colSpan:"9",style:s},this.state.podetails.GrandTotalWord),r.a.createElement("th",{colSpan:"1",style:s},r.a.createElement(ne.a,{value:this.state.podetails.GrandTotal||0,displayType:"text",thousandSeparator:!0})))))),r.a.createElement(k.a,null,r.a.createElement(_.a,{md:4},r.a.createElement(V.a,{bordered:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"2",style:l},"Supplier Info"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Supplier Name"),r.a.createElement("td",null,this.state.podetails.SupplierName)),r.a.createElement("tr",null,r.a.createElement("td",null,"Supplier No"),r.a.createElement("td",null,this.state.podetails.SupplierNumber)),r.a.createElement("tr",null,r.a.createElement("td",null,"Supplier Location"),r.a.createElement("td",null,this.state.podetails.SupplierLocation)),r.a.createElement("tr",null,r.a.createElement("td",null,"Supplier Email"),r.a.createElement("td",null,this.state.podetails.SupplierEmail)),r.a.createElement("tr",null,r.a.createElement("td",null,"Supplier Tel"),r.a.createElement("td",null,this.state.podetails.SupplierTel)),r.a.createElement("tr",null,r.a.createElement("td",null,"Supplier Address"),r.a.createElement("td",null,this.state.podetails.SupplierAddress))))),r.a.createElement(_.a,{md:4},r.a.createElement(V.a,{bordered:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"2",style:l},"Addtional Info")),n))),r.a.createElement(_.a,{md:4},r.a.createElement(V.a,{bordered:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:l},"Remarks 1")),r.a.createElement("tr",null,r.a.createElement("td",null,this.state.podetails.Remark1)),r.a.createElement("tr",null,r.a.createElement("td",{style:l},"Remarks 2")),r.a.createElement("tr",null,r.a.createElement("td",null,this.state.podetails.Remark2)))))),o,c)))}}]),a}(n.Component),Oe=a(906),ye=a(151),De=a.n(ye),Pe=(a(595),{color:"red",marginLeft:"40%",fontSize:"20px"}),Se={padding:"10%"},Ne=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var s;return Object(o.a)(this,a),(s=t.call(this,e,n)).itemViewFormatter=function(e){return r.a.createElement(g.a,{className:"table-anchor",to:"/po-request/view/".concat(e.dependentValues.Id)},"POTN",e.value)},s.itemPDFViewFormatter=function(e){var t="";return"Approved"===e.value&&(t=r.a.createElement("a",{style:Pe,target:"_blank",rel:"noopener noreferrer",href:"https://alrashidabetong.sharepoint.com/sites/apps/PMO/GeneratedPurchaseOrders/".concat(e.dependentValues.chff,"-").concat(e.dependentValues.POVersion,".pdf")},r.a.createElement(d.a,{icon:p.c,className:"mr-2"}))),t},s.SOitemPDFViewFormatter=function(e){var t="";return"Approved"===e.value&&(t=r.a.createElement("a",{style:Pe,target:"_blank",rel:"noopener noreferrer",href:"https://alrashidabetong.sharepoint.com/sites/apps/PMO/SupplierPOReport/".concat(e.dependentValues.chff,"-").concat(e.dependentValues.POVersion,".pdf")},r.a.createElement(d.a,{icon:p.c,className:"mr-2"}))),t},s.DateFormatter=function(e){return r.a.createElement("div",{className:"text-center py-2"},r.a.createElement("span",null,s.formatDate(e.value)))},s.GrandTotalFormatter=function(e){return r.a.createElement(ne.a,{style:Se,value:e.value||0,displayType:"text",thousandSeparator:!0,prefix:"".concat(JSON.parse(e.dependentValues.POJSONData).Currency," ")})},s.initColumnDefs=function(){s._columns=[{key:"Id",name:"Ticket Number",formatter:s.itemViewFormatter,getRowMetaData:function(e){return e},width:"5%",Id:s.props.value},{key:"chff",name:"PO Number",width:"5%"},{key:"j3xm",name:"PO Maker",width:"5%"},{key:"ozud",name:"Department",width:"5%"},{key:"yyrh",name:"Grand Total",width:"10%",textAlign:"right !important",formatter:s.GrandTotalFormatter,getRowMetaData:function(e){return e}},{key:"Created",name:"Requested Date",width:"5%",formatter:s.DateFormatter},{key:"RequestStatus",name:"Request Status",width:"25%"},{key:"ApprovalStatus",name:"Approval Status",width:"25%"},{key:"RespondedDate",name:"Responded Date",width:"25%"},{key:"PendingWith",name:"Pending With",width:"25%"},{key:"POStatus",name:"IPOC",formatter:s.itemPDFViewFormatter,width:"1%",getRowMetaData:function(e){return e}},{key:"POStatus",name:"SPOC",formatter:s.SOitemPDFViewFormatter,width:"1%",getRowMetaData:function(e){return e}}]},s.rowGetter=function(e){return s.props.PODetails[e]},s.initColumnDefs(),s}return Object(i.a)(a,[{key:"formatDate",value:function(e){return r.a.createElement(Z.a,{format:"MM/DD/YYYY hh:mm"},e)}},{key:"render",value:function(){var e;return this.props.PODetails?(console.log(void 0),e=r.a.createElement(De.a,{columns:this._columns,rowGetter:this.rowGetter,rowsCount:this.props.PODetails.length,minHeight:1e3,isScrolling:!1,sortColumn:!0,width:100})):e=r.a.createElement("div",{className:"text-center"},r.a.createElement(Oe.a,{className:"mr-3",animation:"border",variant:"secondary"}),r.a.createElement("span",null,"Loading PO Details ...")),r.a.createElement($.a,{style:{width:"100%"}},r.a.createElement(k.a,null,r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(d.a,{icon:p.b,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Purchase Order Requests")),r.a.createElement(_.a,{md:12},e)))}}]),a}(n.Component),we=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).GetPODetails=function(){fe("PMO").then((function(e){return r.setState({PODetails:e,loaded:!0})}))},r.handleSearchInput=function(e){r.setState({PONumber:e.target.value})},r.searchData=function(){r.filterItems({PONumber:r.state.PONumber}).then((function(e){r.setState({PODetails:e})}))},r.resetSearch=function(){r.GetPODetails()},r.filterRequestStatus=function(e){r.setState({RequestStatusFilter:e.target.value})},r.filterApprovalStatus=function(e){r.setState({ApprovalStatusFilter:e.target.value})},r.filterDepartment=function(e){r.setState({DepartmentFilter:e.target.value})},r.filterPOMaker=function(e){r.setState({POMakerFilter:e.target.value})},r.state={loaded:!1,PODetails:null,PONumber:"",RequestStatusFilter:"All",DepartmentFilter:"All",ApprovalStatusFilter:"All",POMakerFilter:"All"},r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.GetPODetails()}},{key:"filterItems",value:function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n,r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=Object(G.a)(this.state.PODetails);try{for(n.s();!(r=n.n()).done;)(s=r.value).chff.indexOf(t.PONumber)>-1&&a.push(s)}catch(l){n.e(l)}finally{n.f()}return e.abrupt("return",Promise.resolve(a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a=this,n=this.state.PODetails;if("All"!==this.state.RequestStatusFilter&&(n=n.filter((function(e){return e.RequestStatus===a.state.RequestStatusFilter}))),"All"!==this.state.ApprovalStatusFilter&&(n=n.filter((function(e){return e.ApprovalStatus===a.state.ApprovalStatusFilter}))),"All"!==this.state.DepartmentFilter&&(n=n.filter((function(e){return e.ozud===a.state.DepartmentFilter}))),"All"!==this.state.POMakerFilter&&(n=n.filter((function(e){return e.j3xm===a.state.POMakerFilter}))),this.state.PODetails){var s=Object(le.a)(new Set(this.state.PODetails.map((function(e){return e.ozud}))));e=r.a.createElement(B.a,{type:"select",name:"select",id:"exampleSelect",onChange:this.filterDepartment},r.a.createElement("option",{defaultValue:!0},"All"),s.map((function(e,t){return r.a.createElement("option",{key:t},e)})),";")}if(this.state.PODetails){var l=Object(le.a)(new Set(this.state.PODetails.map((function(e){return e.j3xm}))));t=r.a.createElement(B.a,{type:"select",name:"select",id:"exampleSelect",onChange:this.filterPOMaker},r.a.createElement("option",{defaultValue:!0},"All"),l.map((function(e,t){return r.a.createElement("option",{key:t},e)})),";")}return r.a.createElement("div",{style:{minWidth:"100%",maxWidth:"100%"}},r.a.createElement($.a,{style:{width:"100%"},className:"mb-3"},r.a.createElement(k.a,null,r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(d.a,{icon:p.e,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Filter Purchase Order Requests"))),r.a.createElement("form",{className:"form-horizontal"},r.a.createElement(U.a,{row:!0},r.a.createElement("div",{className:"col-md-3"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"POMaker"),t),r.a.createElement("div",{className:"col-md-9",id:"legend"},r.a.createElement("p",{className:"mt-2"},r.a.createElement("span",{id:"ShortF"},"PM:")," Purchase Manager",r.a.createElement("span",{id:"ShortF"},"DM:")," Department Manager",r.a.createElement("span",{id:"ShortF"},"GM:")," General Manager")))),r.a.createElement("form",{className:"form-horizontal"},r.a.createElement(U.a,{row:!0},r.a.createElement("div",{className:"col-md-3"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Request Status"),r.a.createElement(B.a,{type:"select",name:"select",id:"exampleSelect",onChange:this.filterRequestStatus},r.a.createElement("option",{defaultValue:!0},"All"),r.a.createElement("option",null,"Not Started"),r.a.createElement("option",null,"In Progress"),r.a.createElement("option",null,"Completed"))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Approval Status"),r.a.createElement(B.a,{type:"select",name:"select",id:"exampleSelect",onChange:this.filterApprovalStatus},r.a.createElement("option",{defaultValue:!0},"All"),r.a.createElement("option",null,"PM-Approved"),r.a.createElement("option",null,"DM-Approved"),r.a.createElement("option",null,"GM-Approved"),r.a.createElement("option",null,"PM-Rejected"),r.a.createElement("option",null,"DM-Rejected"),r.a.createElement("option",null,"GM-Rejected"))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Department"),e),r.a.createElement("div",{className:"col-md-3"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Search PO"),r.a.createElement("div",{className:"input-group-append"},r.a.createElement(B.a,{type:"text",placeholder:"Enter PO Number",value:this.state.PONumber,onChange:this.handleSearchInput}),r.a.createElement("button",{className:"btn btn-sm btn-success mr-2 ml-2 btn-cancel",onClick:this.searchData,type:"button"},"Search"),r.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:this.resetSearch,type:"button"},"Reset")))))),r.a.createElement(Ne,{PODetails:n}))}}]),a}(n.Component),je=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var s;return Object(o.a)(this,a),(s=t.call(this,e,n)).itemViewFormatter=function(e){return r.a.createElement("a",{className:"table-anchor",target:"_self",rel:"noopener noreferrer",href:"/sites/apps/pmo/WorkflowTasks/EditForm.aspx?ID=".concat(e.dependentValues.Id)},e.value)},s.GrandTotalFormatter=function(e){return null===e.dependentValues.Currency?r.a.createElement(ne.a,{style:{textAlign:"right"},value:e.value||0,displayType:"text",thousandSeparator:!0,prefix:"SAR"}):r.a.createElement(ne.a,{style:{textAlign:"right"},value:e.value||0,displayType:"text",thousandSeparator:!0,prefix:"".concat(e.dependentValues.Currency," ")})},s.DateFormatter=function(e){return r.a.createElement("div",{className:"text-center py-2"},r.a.createElement("span",null,s.formatDate(e.value)))},s.CheckPriority=function(e){return"High"===e.value?r.a.createElement("div",{style:{background:"rgba(220, 53, 69,0.7)",color:"white",fontWeight:"bold",textAlign:"center"}},e.value):r.a.createElement("div",null,e.value)},s.initColumnDefs=function(){s._columns=[{key:"Id",name:"Task ID",width:"5%"},{key:"PONumber",name:"PO Number",width:"10%",formatter:s.itemViewFormatter,getRowMetaData:function(e){return e}},{key:"InitiatorName",name:"Initiator Name",width:"15%"},{key:"Department",name:"Department",width:"15%"},{key:"Created",name:"Assigned Date",width:"15%",formatter:s.DateFormatter},{key:"DueDate",name:"Due Date",width:"15%",formatter:s.DateFormatter},{key:"GrandTotal",name:"Grand Total",width:"10%",formatter:s.GrandTotalFormatter,getRowMetaData:function(e){return e}},{key:"Status",name:"Status",width:"15%"},{key:"ReviwalStatus",name:"Reviewal Status",width:"15%"},{key:"RespondedDate",name:"RespondedDate",width:"15%"},{key:"POPriority",name:"Priority",width:"15%",formatter:s.CheckPriority,getRowMetaData:function(e){return e}}]},s.rowGetter=function(e){return s.props.TaskDetails[e]},s.initColumnDefs(),s}return Object(i.a)(a,[{key:"formatDate",value:function(e){return r.a.createElement(Z.a,{format:"DD-MM-YYYY  hh:mm"},e)}},{key:"render",value:function(){var e;return e=this.props.TaskDetails?r.a.createElement(De.a,{columns:this._columns,rowGetter:this.rowGetter,rowsCount:this.props.TaskDetails.length,minHeight:1e3,isScrolling:!1,sortColumn:!0}):r.a.createElement("div",{className:"text-center"},r.a.createElement(Oe.a,{className:"mr-3",animation:"border",variant:"secondary"}),r.a.createElement("span",null,"Loading Task Details ...")),r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{style:{width:"100%"}},r.a.createElement(k.a,null,r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(d.a,{icon:p.b,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"My Workflow Tasks")),r.a.createElement(_.a,{md:12},e))))}}]),a}(n.Component),ke=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).GetTaskDetails=function(){N().then((function(e){return r.setState({CurrentUserID:e})})),P("Workflow Tasks",r.state.CurrentUserID).then((function(e){return r.setState({TaskDetails:e.filter((function(e){return e.AssignedToId===r.state.CurrentUserID&e.Data===r.state.DataValue})),CurrentStatus:"In Progress"})}))},r.handleSearchInput=function(e){r.setState({PONumber:e.target.value})},r.searchData=function(){r.filterItems({PONumber:r.state.PONumber}).then((function(e){r.setState({TaskDetails:e,CurrentStatus:""})}))},r.resetSearch=function(e){r.setState({CurrentStatus:document.getElementById("exampleSelect").value}),r.GetTaskDetails()},r.filterStatus=function(e){r.setState({CurrentStatus:document.getElementById("exampleSelect").value,loaded:!1,TaskDetails:null,PONumber:""})},r.state={loaded:!1,TaskDetails:null,PONumber:"",CurrentUserID:"1",CurrentStatus:"All",DataValue:"True",DepartmentFilter:"All"},r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.GetTaskDetails()}},{key:"filterItems",value:function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n,r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=Object(G.a)(this.state.TaskDetails);try{for(n.s();!(r=n.n()).done;)(s=r.value).PONumber.indexOf(t.PONumber)>-1&&a.push(s)}catch(l){n.e(l)}finally{n.f()}return e.abrupt("return",Promise.resolve(a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.TaskDetails;return"In Progress"===this.state.CurrentStatus&&P("Workflow Tasks",this.state.CurrentUserID).then((function(t){return e.setState({TaskDetails:t.filter((function(t){return t.AssignedToId===e.state.CurrentUserID&t.Data===e.state.DataValue})),CurrentStatus:""})})),"Completed"===this.state.CurrentStatus&&S("Workflow Tasks",this.state.CurrentUserID).then((function(t){return e.setState({TaskDetails:t.filter((function(t){return t.AssignedToId===e.state.CurrentUserID&t.Data===e.state.DataValue})),CurrentStatus:""})})),r.a.createElement("div",{style:{minWidth:"100%",maxWidth:"100%"}},r.a.createElement($.a,{style:{width:"100%"},className:"mb-3"},r.a.createElement(k.a,null,r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(d.a,{icon:p.e,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Filter My Tasks"))),r.a.createElement("form",{className:"form-horizontal"},r.a.createElement(U.a,{row:!0},r.a.createElement("div",{className:"col-md-4"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Filter by Status"),r.a.createElement(B.a,{type:"select",name:"select",id:"exampleSelect",onChange:this.filterStatus},r.a.createElement("option",null,"In Progress"),r.a.createElement("option",{value:"Completed"},"Tasks completed recently"))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Search PO"),r.a.createElement("div",{className:"input-group-append"},r.a.createElement(B.a,{type:"text",placeholder:"Enter PO Number",value:this.state.PONumber,onChange:this.handleSearchInput}),r.a.createElement("button",{className:"btn btn-sm btn-success mr-2 ml-2 btn-cancel",onClick:this.searchData,type:"button"},"Search"),r.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:this.resetSearch,type:"button"},"Reset")))))),r.a.createElement(je,{TaskDetails:t}))}}]),a}(n.Component),xe=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e,t=localStorage.getItem("POHomeURL");return console.log(t),null!==t&&(e=r.a.createElement(I.b,{to:"".concat(t)}),localStorage.removeItem("POHomeURL")),r.a.createElement("div",null,e)}}]),a}(n.Component),Te=a(526),Ce=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=PendingWith eq 'Purchase MGR'&$top=10000&$orderby=ID%20desc"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.d.results.length);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=PendingWith eq 'Depart. MGR'&$top=10000&$orderby=ID%20desc"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.d.results.length);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=(a(73),function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=PendingWith eq 'Purchase MGR' and Created ge datetime'").concat(a,"' and Created le datetime'").concat(n,"'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log(s.d.results.length),e.abrupt("return",s.d.results.length);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()),Re=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=PendingWith eq 'Depart. MGR' and Created ge datetime'").concat(a,"' and Created le datetime'").concat(n,"''"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log(s.d.results.length),e.abrupt("return",s.d.results.length);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=ResponseForDashboard eq 'Approved' and Created ge datetime'").concat(a,"' and Created le datetime'").concat(n,"'&$top=10000&$orderby=ID%20desc'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log(s.d.results.length),e.abrupt("return",s.d.results.length);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=Created ge datetime'").concat(a,"' and Created le datetime'").concat(n,"'&$top=10000&$orderby=ID%20desc'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log(s.d.results.length),e.abrupt("return",s.d.results.length);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=ResponseForDashboard eq 'Rejected' and Created ge datetime'").concat(a,"' and Created le datetime'").concat(n,"'&$top=10000&$orderby=ID%20desc'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,console.log(s.d.results.length),e.abrupt("return",s.d.results.length);case 8:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),qe=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=PendingWith eq 'General MGR' and Created ge datetime'").concat(a,"' and Created le datetime'").concat(n,"'&$top=10000&$orderby=ID%20desc'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,e.abrupt("return",s.d.results.length);case 7:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=PendingWith eq 'General MGR'&$top=10000&$orderby=ID%20desc"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.d.results.length);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=ResponseForDashboard eq 'Approved'&$top=10000&$orderby=ID%20desc"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.d.results.length);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=ResponseForDashboard eq 'Rejected'&$top=10000&$orderby=ID%20desc"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.d.results.length);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$top=10000&$orderby=ID%20desc'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,console.log(n.d.results),e.abrupt("return",n.d.results.length);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=a(125),Be=a.n(_e),Le=a(484),Ye=new Date,ze=Ye.getFullYear(),Je=Ye.getUTCMonth()+1,He=Je.toString().length<2?"0".concat(Je):Je,Ze=Ye.getUTCDate().toString().length<2?"0".concat(Ye.getUTCDate()):Ye.getUTCDate(),Qe=("".concat(ze,"-").concat(He,"-").concat(Ze),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).Dash=function(){Ue("PMO").then((function(e){return r.setState({Total:e})})),Ce("PMO").then((function(e){return r.setState({PMPending:e})})),Ae("PMO").then((function(e){return r.setState({DMPending:e})})),Ve("PMO").then((function(e){return r.setState({GMPending:e})})),$e("PMO").then((function(e){return r.setState({Approved:e})})),We("PMO").then((function(e){return r.setState({Rejected:e})}))},r.getdata=function(){Ue("PMO").then((function(e){return r.setState({Total:e})})),$e("PMO").then((function(e){return r.setState({Approved:e})})),We("PMO").then((function(e){return r.setState({Rejected:e})})),Ce("PMO").then((function(e){return r.setState({PMPending:e})})),Ae("PMO").then((function(e){return r.setState({DMPending:e})})),Ve("PMO").then((function(e){return r.setState({GMPending:e})}))},r.PeriodData=function(){""===r.state.fromDate?Y()("Please choose From Date"):""===r.state.TODate?Y()("Please choose End Date"):(console.log(r.state.fromDate),console.log(r.state.TODate),Ie("PMO",r.state.fromDate,r.state.TODate).then((function(e){return r.setState({Approved:e})})),Ge("PMO",r.state.fromDate,r.state.TODate).then((function(e){return r.setState({Rejected:e})})),Fe("PMO",r.state.fromDate,r.state.TODate).then((function(e){return r.setState({Total:e})})),Me("PMO",r.state.fromDate,r.state.TODate).then((function(e){return r.setState({PMPending:e})})),Re("PMO",r.state.fromDate,r.state.TODate).then((function(e){return r.setState({DMPending:e})})),qe("PMO",r.state.fromDate,r.state.TODate).then((function(e){return r.setState({GMPending:e})})))},r.state={PMPending:"",DMPending:"",GMPending:"",Approved:"",Rejected:"",Total:"",RequestDuration:"All",fromDate:"",TODate:""},r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.Dash()}},{key:"render",value:function(){var e=this,t={width:"100%"},a={width:"100%"},n={minWidth:"100%",maxWidth:"100%"};return r.a.createElement("div",{style:n},r.a.createElement($.a,{style:t},r.a.createElement(k.a,null,r.a.createElement("p",{id:"Expo"},"Filter PO Status"),r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(Le.a,{id:"date",type:"date",onChange:function(t){var a=t.target.value+"T00:00:00.000Z";e.setState({fromDate:a})}}),r.a.createElement(Le.a,{id:"date",type:"date",onChange:function(t){var a=t.target.value+"T00:00:00.000Z";e.setState({TODate:a})}}),r.a.createElement("button",{className:"btn btn-sm btn-success mr-2 ml-2 btn-cancel",onClick:this.PeriodData,type:"button"},"Search"),r.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:this.getdata,type:"button"},"Reset")))),r.a.createElement("br",null),r.a.createElement($.a,{style:t,className:"mb-3"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 col-sm-6 col-lg-6"},r.a.createElement("div",{className:"col-md-12 col-sm-12 col-lg-12"},r.a.createElement("p",{className:"DashboardName"},"Purchase Order Request"),r.a.createElement("div",{className:" col-md-6 col-sm-6 col-lg-6 ",id:"TotalRequest"},r.a.createElement("p",null,"Total Request"),r.a.createElement("p",{id:"TR"},r.a.createElement(Be.a,{start:0,end:this.state.Total}))))),r.a.createElement("div",{className:"col-md-6 col-lg-6 col-sm-6 col-xs-6"},r.a.createElement("div",{style:n},r.a.createElement(Te.a,{style:n,data:{labels:["Pendng with Purchase Manager","Pendng with Department Manager","Pendng with General Manager"],datasets:[{label:"Request Status",backgroundColor:["#B21F00","#C9DE00","#2FDE00"],hoverBackgroundColor:["#501800","#4B5000","#175000"],data:[this.state.PMPending,this.state.DMPending,this.state.GMPending]}]},options:{title:{display:!0,text:"",fontSize:20},legend:{display:!0,position:"right"}}}))," "),"  ")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{style:n},r.a.createElement($.a,{style:a,className:"mb-3",id:"DashTabs"},r.a.createElement("div",{className:"StatusCoumn"},r.a.createElement("p",{className:"statusheading"},"Pending with Purchase Manager"),r.a.createElement("p",{className:"PMItems"},r.a.createElement(Be.a,{start:0,end:this.state.PMPending})))))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{style:n},r.a.createElement($.a,{style:a,className:"mb-3",id:"DashTabs"},r.a.createElement("div",{className:"StatusCoumn"},r.a.createElement("p",{className:"statusheading"},"Pending with Department Manager"),r.a.createElement("p",{className:"PMItems"},r.a.createElement(Be.a,{start:0,end:this.state.DMPending})))))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{style:n},r.a.createElement($.a,{style:a,className:"mb-3",id:"DashTabs"},r.a.createElement("div",{className:"StatusCoumn"},r.a.createElement("p",{className:"statusheading"},"Pending with General Manager"),r.a.createElement("p",{className:"PMItems"},r.a.createElement(Be.a,{start:0,end:this.state.GMPending}))))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-4 "},r.a.createElement("div",{style:n},r.a.createElement($.a,{style:a,className:"mb-3",id:"DashTabs"},r.a.createElement("div",{className:"StatusCoumn"},r.a.createElement("p",{className:"statusheading"},"Pending with Asst General Manager"),r.a.createElement("p",{className:"PMItems"},r.a.createElement(Be.a,{start:0,end:this.state.Approved})))))),r.a.createElement("div",{className:"col-md-4 "},r.a.createElement("div",{style:n},r.a.createElement($.a,{style:a,className:"mb-3",id:"DashTabs"},r.a.createElement("div",{className:"StatusCoumn"},r.a.createElement("p",{className:"statusheading"},"Approved PO"),r.a.createElement("p",{className:"PMItems"},r.a.createElement(Be.a,{start:0,end:this.state.Approved})))))),r.a.createElement("div",{className:"col-md-4"},r.a.createElement("div",{style:n},r.a.createElement($.a,{style:a,className:"mb-3",id:"DashTabs"},r.a.createElement("div",{className:"StatusCoumn"},r.a.createElement("p",{className:"statusheading"},"Rejected PO"),r.a.createElement("p",{className:"PMItems"},r.a.createElement(Be.a,{start:0,end:this.state.Rejected}))))))))}}]),a}(r.a.Component)),Xe=a(331),Ke=a.n(Xe),et=function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n,r,s,l,c,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?&$top=10000&$orderby=ID%20desc')"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return a=e.sent,n=[],e.next=6,a.json();case 6:for(r=e.sent,console.log(r.d.results),s=0;s<r.d.results.length;s++)l=r.d.results[s].yyrh,c="".concat(JSON.parse(r.d.results[s].POJSONData).Currency," "),o=(c+l).replace(/"([^"]+(?="))"/g,"$1"),console.log(o),n.push({TicketNumber:r.d.results[s].vwno,RespondedDate:r.d.results[s].RespondedDate,PONumber:r.d.results[s].chff,POMaker:r.d.results[s].j3xm,Department:r.d.results[s].ozud,GrandTotal:o,RequestedDate:r.d.results[s].Created,RequestStatus:r.d.results[s].RequestStatus,ApprovalStatus:r.d.results[s].ApprovalStatus,PendingWith:r.d.results[s].PendingWith});return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tt=function(){var e=Object(D.a)(y.a.mark((function e(t,a,n){var s,l,c,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$select=*&$filter=(Created ge datetime'").concat(a,"') and (Created le datetime'").concat(n,"')"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return s=e.sent,l=[],e.next=6,s.json();case 6:for(c=e.sent,console.log(c.d.results),o=0;o<c.d.results.length;o++)l.push({TicketNumber:c.d.results[o].vwno,PONumber:c.d.results[o].chff,POMaker:c.d.results[o].j3xm,Department:c.d.results[o].ozud,GrandTotal:r.a.createElement(ne.a,{style:{textAlign:"right"},value:c.d.results[o].yyrh||0,displayType:"text",thousandSeparator:!0,prefix:"".concat(JSON.parse(c.d.results[o].POJSONData).Currency," ")}),RequestedDate:c.d.results[o].Created,RequestStatus:c.d.results[o].RequestStatus,ApprovalStatus:c.d.results[o].ApprovalStatus,PendingWith:c.d.results[o].PendingWith});return e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}();function at(e){var t=e.columnDef,a=e.onFilterChanged;return r.a.createElement(Le.a,{id:"date",type:"date",defaultValue:"2020-07-28",onChange:function(e){a(t.tableData.id,e.target.value)}})}var nt=a(531),rt=a.n(nt),st=a(541),lt=a.n(st),ct=a(532),ot=a.n(ct),it=a(539),ut=a.n(it),mt=a(339),dt=a.n(mt),pt=a(338),ht=a.n(pt),ft=a(533),Et=a.n(ft),bt=a(534),vt=a.n(bt),gt=a(536),Ot=a.n(gt),yt=a(537),Dt=a.n(yt),Pt=a(538),St=a.n(Pt),Nt=a(542),wt=a.n(Nt),jt=a(535),kt=a.n(jt),xt=a(540),Tt=a.n(xt),Ct=a(543),At=a.n(Ct),Mt={Add:Object(n.forwardRef)((function(e,t){return r.a.createElement(rt.a,Object.assign({},e,{ref:t}))})),Check:Object(n.forwardRef)((function(e,t){return r.a.createElement(ot.a,Object.assign({},e,{ref:t}))})),Clear:Object(n.forwardRef)((function(e,t){return r.a.createElement(ht.a,Object.assign({},e,{ref:t}))})),Delete:Object(n.forwardRef)((function(e,t){return r.a.createElement(Et.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(n.forwardRef)((function(e,t){return r.a.createElement(dt.a,Object.assign({},e,{ref:t}))})),Edit:Object(n.forwardRef)((function(e,t){return r.a.createElement(vt.a,Object.assign({},e,{ref:t}))})),Export:Object(n.forwardRef)((function(e,t){return r.a.createElement(kt.a,Object.assign({},e,{ref:t}))})),Filter:Object(n.forwardRef)((function(e,t){return r.a.createElement(Ot.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(Dt.a,Object.assign({},e,{ref:t}))})),LastPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(St.a,Object.assign({},e,{ref:t}))})),NextPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(dt.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(n.forwardRef)((function(e,t){return r.a.createElement(ut.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(n.forwardRef)((function(e,t){return r.a.createElement(ht.a,Object.assign({},e,{ref:t}))})),Search:Object(n.forwardRef)((function(e,t){return r.a.createElement(Tt.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(n.forwardRef)((function(e,t){return r.a.createElement(lt.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(n.forwardRef)((function(e,t){return r.a.createElement(wt.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(n.forwardRef)((function(e,t){return r.a.createElement(At.a,Object.assign({},e,{ref:t}))}))},Rt=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var s;return Object(o.a)(this,a),(s=t.call(this,e,n)).GrandTotalFormatter=function(e){return r.a.createElement(ne.a,{style:{textAlign:"right"},value:e.value||0,displayType:"text",thousandSeparator:!0,prefix:"".concat(JSON.parse((void 0).dependentValues.POJSONData).Currency," ")})},s.PeriodData=function(){console.log(s.state.fromDate),console.log(s.state.TODate),void 0===s.state.fromDate?Y()("Provide From Date"):void 0===s.state.TODate?Y()("Provide To Date"):tt("PMO",s.state.fromDate,s.state.TODate).then((function(e){return s.setState({PODetails:e})}))},s.getdata=function(){et("PMO").then((function(e){return s.setState({PODetails:e})}))},s.state={loaded:!1,PODetails:[]},s}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getdata()}},{key:"render",value:function(){var e=this;this.state.PODetails;console.log(this.state.PODetails);var t=r.a.createElement(Ke.a,{icons:Mt,title:"",columns:[{title:"Ticket Number",field:"TicketNumber"},{title:"PO Number",field:"PONumber"},{title:"PO Maker",field:"POMaker"},{title:"Department",field:"Department"},{title:"Grand Total",field:"GrandTotal",formatter:this.GrandTotalFormatter},{title:"Requested Date",field:"RequestedDate",filterComponent:at},{title:"Request Status",field:"RequestStatus"},{title:"Approval Status",field:"ApprovalStatus"},{title:"Pending with",field:"PendingWith"},{title:"Responded Date",field:"RespondedDate"}],data:this.state.PODetails,options:{exportButton:!0,pageSize:50,isLoading:!0,exportAllData:!0}});return r.a.createElement("div",{style:{minWidth:"100%",maxWidth:"100%"}},r.a.createElement($.a,{style:{width:"100%"}},r.a.createElement(k.a,null,r.a.createElement("p",{id:"Expo"},"Export PO with in dates"),r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(Le.a,{id:"date",type:"date",onChange:function(t){var a=t.target.value+"T00:00:00.000Z";e.setState({fromDate:a})}}),r.a.createElement(Le.a,{id:"date",type:"date",onChange:function(t){var a=t.target.value+"T00:00:00.000Z";e.setState({TODate:a})}}),r.a.createElement("button",{ref:"Btn",className:"btn btn-sm btn-success mr-2 ml-2 btn-cancel",onClick:this.PeriodData,type:"button"},"Search"),r.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:this.getdata,type:"button"},"Reset")))),r.a.createElement("br",null),t)}}]),a}(n.Component),It=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var s;return Object(o.a)(this,a),(s=t.call(this,e,n)).itemViewFormatter=function(e){return r.a.createElement("a",{className:"table-anchor",target:"_self",rel:"noopener noreferrer",href:"/sites/apps/PMO/Lists/ttt%20Tasks/EditForm.aspx?ID=".concat(e.dependentValues.Id)},e.value)},s.GrandTotalFormatter=function(e){return null===e.dependentValues.Currency?r.a.createElement(ne.a,{style:{textAlign:"right"},value:e.value||0,displayType:"text",thousandSeparator:!0,prefix:"SAR"}):r.a.createElement(ne.a,{style:{textAlign:"right"},value:e.value||0,displayType:"text",thousandSeparator:!0,prefix:"".concat(e.dependentValues.Currency," ")})},s.DateFormatter=function(e){return r.a.createElement("div",{className:"text-center py-2"},r.a.createElement("span",null,s.formatDate(e.value)))},s.CheckPriority=function(e){return"High"===e.value?r.a.createElement("div",{style:{background:"rgba(220, 53, 69,0.7)",color:"white",fontWeight:"bold",textAlign:"center"}},e.value):r.a.createElement("div",null,e.value)},s.initColumnDefs=function(){s._columns=[{key:"Id",name:"Task ID",width:"5%"},{key:"PONumber",name:"PO Number",width:"10%",formatter:s.itemViewFormatter,getRowMetaData:function(e){return e}},{key:"InitiatorName",name:"Initiator Name",width:"15%"},{key:"Department",name:"Department",width:"15%"},{key:"Created",name:"Assigned Date",width:"15%",formatter:s.DateFormatter},{key:"DueDate",name:"Due Date",width:"15%",formatter:s.DateFormatter},{key:"GrandTotal",name:"Grand Total",width:"10%",formatter:s.GrandTotalFormatter,getRowMetaData:function(e){return e}},{key:"Status",name:"Status",width:"15%"},{key:"ReviwalStatus",name:"Reviewal Status",width:"15%"},{key:"RespondedDate",name:"RespondedDate",width:"15%"},{key:"POPriority",name:"Priority",width:"15%",formatter:s.CheckPriority,getRowMetaData:function(e){return e}}]},s.rowGetter=function(e){return s.props.TaskDetails[e]},s.initColumnDefs(),s}return Object(i.a)(a,[{key:"formatDate",value:function(e){return r.a.createElement(Z.a,{format:"DD-MM-YYYY  hh:mm"},e)}},{key:"render",value:function(){var e;return e=this.props.TaskDetails?r.a.createElement(De.a,{columns:this._columns,rowGetter:this.rowGetter,rowsCount:this.props.TaskDetails.length,minHeight:1e3,isScrolling:!1,sortColumn:!0}):r.a.createElement("div",{className:"text-center"},r.a.createElement(Oe.a,{className:"mr-3",animation:"border",variant:"secondary"}),r.a.createElement("span",null,"Loading Task Details ...")),r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{style:{width:"100%"}},r.a.createElement(k.a,null,r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(d.a,{icon:p.b,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"My Completed Tasks")),r.a.createElement(_.a,{md:12},e))))}}]),a}(n.Component),Ft=function(){var e=Object(D.a)(y.a.mark((function e(t,a){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/sites/apps/PMO/_api/web/lists/GetByTitle('".concat(t,"')/items?$filter=AssignedTo eq '").concat(a,"'"),{headers:{"Content-Type":"application/json",Accept:"application/json; odata=verbose"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r.d.results);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Gt=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).getuserid=function(){},r.GetTaskDetails=function(){N().then((function(e){return r.setState({CurrentUserID:e})})),Ft("Completed Tasks","10").then((function(e){return r.setState({TaskDetails:e.filter((function(e){return e.AssignedToId===r.state.CurrentUserID&e.Data===r.state.DataValue})),loaded:!0,CurrentStatus:"Completed"})}))},r.handleSearchInput=function(e){r.setState({PONumber:e.target.value})},r.searchData=function(){r.filterItems({PONumber:r.state.PONumber}).then((function(e){r.setState({TaskDetails:e})}))},r.resetSearch=function(){r.GetTaskDetails()},r.filterStatus=function(e){r.setState({CurrentStatus:e.target.value,loaded:!1,TaskDetails:null,PONumber:""})},r.state={loaded:!1,TaskDetails:null,PONumber:"",CurrentUserID:"1",CurrentStatus:"All",DataValue:"True",DepartmentFilter:"All"},r}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getuserid(),this.GetTaskDetails()}},{key:"filterItems",value:function(){var e=Object(D.a)(y.a.mark((function e(t){var a,n,r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=Object(G.a)(this.state.TaskDetails);try{for(n.s();!(r=n.n()).done;)(s=r.value).PONumber.indexOf(t.PONumber)>-1&&a.push(s)}catch(l){n.e(l)}finally{n.f()}return e.abrupt("return",Promise.resolve(a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;"Completed"===this.state.CurrentStatus&&S("Completed Tasks",this.state.CurrentUserID).then((function(t){return e.setState({TaskDetails:t.filter((function(t){return t.AssignedToId||t.AssignedToId0===e.state.CurrentUserID&t.Data===e.state.DataValue})),CurrentStatus:""})}));var t=this.state.TaskDetails;return r.a.createElement("div",{style:{minWidth:"100%",maxWidth:"100%"}},r.a.createElement($.a,{style:{width:"100%"},className:"mb-3"},r.a.createElement(k.a,null,r.a.createElement(_.a,{style:{display:"flex"},className:"form-header-container",md:12},r.a.createElement(d.a,{icon:p.e,className:"mr-2"}),r.a.createElement("h5",{className:"form-header"},"Filter My Tasks"))),r.a.createElement("form",{className:"form-horizontal"},r.a.createElement(U.a,{row:!0},r.a.createElement("div",{className:"col-md-4"},r.a.createElement(ae.a,{for:"exampleSelect",className:"mt-2"},"Search PO"),r.a.createElement("div",{className:"input-group-append"},r.a.createElement(B.a,{type:"text",placeholder:"Enter PO Number",value:this.state.PONumber,onChange:this.handleSearchInput}),r.a.createElement("button",{className:"btn btn-sm btn-success mr-2 ml-2 btn-cancel",onClick:this.searchData,type:"button"},"Search"),r.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:this.resetSearch,type:"button"},"Reset")))))),r.a.createElement(It,{TaskDetails:t}))}}]),a}(n.Component),qt=function(e){return r.a.createElement(j.a,{fluid:!0,className:v()("content",{"is-open":e.isOpen})},r.a.createElement(R,{toggle:e.toggle}),r.a.createElement(k.a,{className:"m-1 bg-white"},r.a.createElement(I.e,null,r.a.createElement(I.c,{exact:!0,path:"/",component:xe}),r.a.createElement(I.c,{exact:!0,path:"/po-search",component:te}),r.a.createElement(I.c,{exact:!0,path:"/po-request/:mode",component:ge}),r.a.createElement(I.c,{exact:!0,path:"/po-request/:mode/:id",component:ge}),r.a.createElement(I.c,{exact:!0,path:"/pages/my-tasks",component:ke}),r.a.createElement(I.c,{exact:!0,path:"/pages/my-completed",component:Gt}),r.a.createElement(I.c,{exact:!0,path:"/pages/my-requests",component:we}),r.a.createElement(I.c,{exact:!0,path:"/search-po",component:function(){return"Search PO"}}),r.a.createElement(I.c,{exact:!0,path:"/contact",component:function(){return"Contact"}}),r.a.createElement(I.c,{exact:!0,path:"/pages/Dashboard",component:Qe}),r.a.createElement(I.c,{exact:!0,path:"/pages/ExportPO",component:Rt}))))},Vt=function(e){var t=Object(n.useState)(!0),a=Object(c.a)(t,2),s=a[0],l=a[1],o=function(){return l(!s)};return r.a.createElement(I.a,null,r.a.createElement("div",{className:"App wrapper"},r.a.createElement(w,{toggle:o,isOpen:s}),r.a.createElement(qt,{toggle:o,isOpen:s})))},$t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Wt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(r.a.createElement(Vt,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/sites/apps/PMO",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/sites/apps/PMO","/service-worker.js");$t?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Wt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Wt(e)}))}}()}},[[552,1,2]]]);
//# sourceMappingURL=main.42be699f.chunk.js.map